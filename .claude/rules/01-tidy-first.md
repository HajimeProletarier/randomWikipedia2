# Tidy First? - 整理優先の原則

Kent Beck の教えに基づく、コード変更の作法。

## 核心原則

**「振る舞いの変更」と「構造の変更」を同時にしない**

1. まず構造を整理する (Tidy)
2. その後で振る舞いを変更する
3. コミットは分ける

## Tidying のパターン

### Guard Clauses（ガード節）
```
# Bad: ネストが深い
if condition:
    if another:
        do_something()

# Good: 早期リターン
if not condition:
    return
if not another:
    return
do_something()
```

### Dead Code（死んだコード）
- 使われていないコードは削除する
- 「いつか使うかも」は削除の理由にならない
- Git が履歴を覚えている

### Normalize Symmetries（対称性の正規化）
- 似たような処理は似たような形で書く
- パターンを揃えることで認知負荷を下げる

### Extract Helper（ヘルパーの抽出）
- 意図を名前で表現する
- ただし、1回しか使わないものは抽出しない

## いつ Tidy するか

1. **変更前**: これから触る箇所を整理してから変更
2. **理解のため**: コードを読んで理解したことを構造に反映
3. **小さく**: 大きな Tidy は小さな Tidy の積み重ね

## いつ Tidy しないか

- 動いているコードを「なんとなく」触らない
- 変更予定のない箇所は放置
- チームの合意なく大規模リファクタリングしない
